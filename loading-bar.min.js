(function(e,t){typeof exports==="object"&&typeof module!=="undefined"?t(exports):typeof define==="function"&&define.amd?define(["exports"],t):t(e.loadingBar=e.loadingBar||{})})(this,function(e){"use strict";var t={includeBar:true,includeSpinner:true,loadingBarTemplate:'<div id="loading-bar"><div class="bar"><div class="peg"></div></div></div>',spinnerTemplate:'<div id="loading-bar-spinner"><div class="spinner-icon"></div></div>',parentSelector:"body",autoIncrement:true,startSize:.02};var i=function(){function e(){this._mounted=false;this._shown=false;this._autoIncrement=true;this._status=0}e.prototype.start=function(){if(!this._mounted){this.mount()}if(this._shown){return}if(this._endTimeoutId){clearTimeout(this._endTimeoutId)}this._shown=true;this.set(t.startSize);if(t.includeBar){r(this._barElem,"shown")}if(t.includeSpinner){r(this._spinnerElem,"shown")}};e.prototype.complete=function(){var e=this;if(!this._shown){return}this.set(1);this._shown=false;clearTimeout(this._endTimeoutId);this._endTimeoutId=setTimeout(function(){s(e._barElem,"shown");s(e._spinnerElem,"shown")},300)};e.prototype.set=function(e){var t=this;if(!this._shown){return}var i=e*100+"%";this._barElem.querySelector(".bar").style.width=i;this._status=e;if(this._autoIncrement){clearTimeout(this._incTimeoutId);this._incTimeoutId=setTimeout(function(){t.inc()},250)}};e.prototype.mount=function(){if(!this._barElem){var e=document.createElement("div");e.innerHTML=t.loadingBarTemplate;this._barElem=e.querySelector("#loading-bar")}document.querySelector(t.parentSelector).appendChild(this._barElem);if(!this._spinnerElem){var i=document.createElement("div");i.innerHTML=t.spinnerTemplate;this._spinnerElem=i.querySelector("#loading-bar-spinner")}document.querySelector(t.parentSelector).appendChild(this._spinnerElem);this._mounted=true};e.prototype.inc=function(){if(this._status>=1){return}var e=0;var t=this._status;if(t>=0&&t<.25){e=(Math.random()*(5-3+1)+3)/100}else if(t>=.25&&t<.65){e=Math.random()*3/100}else if(t>=.65&&t<.9){e=Math.random()*2/100}else if(t>=.9&&t<.99){e=.005}else{e=0}var i=this._status+e;this.set(i)};return e}();var n=new i;function r(e,t){var i=e.className||"";var n=i.replace(/(^\s+)|(\s+$)/g,"").split(/\s+/);n.push(t);e.className=n.join(" ")}function s(e,t){var i=e.className||"";var n=i.replace(/(^\s+)|(\s+$)/g,"").split(/\s+/);n=n.filter(function(e){return e!==t});e.className=n.join(" ")}var o=0;var a=0;function u(){n.complete();a=0;o=0}var l={request:function(e){if(e.ignoreLoadingBar){return e}if(o===0){n.start()}o++;n.set(a/o);return e},response:function(e){if(!e||!e.config){return e}if(e.config.ignoreLoadingBar){return e}a++;if(a>=o){u()}else{n.set(a/o)}return e},responseError:function(e){if(!e||!e.config){return Promise.reject(e)}if(e.config.ignoreLoadingBar){return Promise.reject(e)}a++;if(a>=o){u()}else{n.set(a/o)}return Promise.reject(e)}};e["default"]=l;e.defaults=t;Object.defineProperty(e,"__esModule",{value:true})});